<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8" />
		<title>with使用方法</title>
		<script src="http://libs.baidu.com/jquery/2.0.0/jquery.min.js"></script>
		<script src="js/handlebars.js" type="text/javascript" charset="utf-8"></script>
		<style type="text/css">
			* {
				margin: 0;
				padding: 0;
			}
			h1,
			table {
				margin: 0 auto;
				text-align: center;
			}
		</style>
	</head>

	<body>
		<h1>with使用方法</h1>
		<!--基础html框架-->
		<table>
			<thead>
				<tr>
					<th>索引</th>
					<th>姓名</th>
					<th>性别</th>
					<th>年龄</th>
					<th>兴趣爱好</th>
				</tr>
			</thead>

			<tbody id="tableList">
			</tbody>
		</table>
	</body>
	<!--Handlebars.js模版-->
	<!--Handlebars.js模版放在script标签中，保留了html原有层次结构,模版中要写一些操作语句-->
	<!--id可以用来唯一确定一个模版,type是模版固定的写法-->
	<script id="table-template" type="text/x-handlebars-template">
		{{#each this}}
		<tr>
			<td>{{addOne @index}}</td>
			<td>{{name}}</td>
			<td>{{sex}}</td>
			<td>{{age}}</td>
			<td>
				{{#with favorite}} {{#each this}}
				<p>{{name}}</p>
				{{/each}} {{/with}}
			</td>
		</tr>
		{{/each}}
	</script>
	<script type="text/javascript">
		$(function() {
			var data = [{
				name: "张三",
				sex: "男",
				age: 35,
				favorite: [{
					name: "篮球",
				}, {
					name: "唱歌",
				}]
			}, {
				name: "李四",
				sex: "男",
				age: 23,
				favorite: [{
					name: "足球",
				}]
			}, {
				name: "甜妞",
				sex: "女",
				age: 18,
				favorite: [{
					name: "电影",
				}, {
					name: "看书",
				}, {
					name: "爬山",
				}]
			}];
			//注册一个Handlebars模版，通过id找到某一个模版，获取模版的html框架
			var resource = $("#table-template").html();
			var myTemplate = Handlebars.compile(resource);
			//注册一个Handlebars Helper,用来将索引+1，因为默认是从0开始的
			Handlebars.registerHelper("addOne", function(index) {
				return index + 1
			});
			//将json对象用刚刚注册的Handlebars模版封装，得到最终的html，插入到基础table中。
			$('#tableList').html(myTemplate(data));
		});
	</script>

</html>